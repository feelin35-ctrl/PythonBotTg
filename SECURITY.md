# Безопасность хранения токенов Telegram ботов

## Обзор

Для обеспечения безопасности токенов Telegram ботов в этом приложении реализована многоуровневая система безопасности:

1. Использование переменных окружения для хранения токенов в продакшене
2. Ограничение доступа к токенам через API
3. Разделение сред разработки и продакшена
4. Шифрование токенов в файлах (для разработки)

## Рекомендации по безопасности

### Для продакшена

1. **Используйте переменные окружения**:
   - Установите токены в переменных окружения сервера
   - Используйте формат: `BOT_TOKEN_<BOT_ID>=<токен>`
   - Например: `BOT_TOKEN_MAINBOT=123456789:ABCdefGhIjKlMnOpqrsTUVwxyZ`

2. **Не храните токены в файлах**:
   - В продакшене токены не сохраняются в файлы `bot_tokens.json`
   - Файл `bot_tokens.json` игнорируется в продакшене
   - API эндпоинты для сохранения/удаления токенов отключены в продакшене

3. **Настройте сервер**:
   - Установите переменную окружения `ENVIRONMENT=production`
   - Ограничьте доступ к файлам конфигурации сервера

### Для разработки

1. **Файл конфигурации**:
   - Для локальной разработки можно использовать файл `.env`
   - Пример содержимого:
     ```
     ENVIRONMENT=development
     BOT_TOKEN_MAINBOT=123456789:ABCdefGhIjKlMnOpqrsTUVwxyZ
     BOT_TOKEN_TESTBOT=987654321:ZyxwVUtSrqPoNmLkJiHgFeDcBa
     ```

2. **Локальное хранилище**:
   - Токены сохраняются в файл `bot_tokens.json` только в разработке
   - В продакшене этот файл не используется

## Как использовать

### В продакшене:
1. Установите переменные окружения на сервере:
   ```bash
   export ENVIRONMENT=production
   export BOT_TOKEN_MYBOT=your_telegram_bot_token_here
   ```

2. Перезапустите приложение

### В разработке:
1. Создайте файл `.env` в корне проекта:
   ```
   ENVIRONMENT=development
   BOT_TOKEN_MYBOT=your_telegram_bot_token_here
   ```

2. Запустите приложение в обычном режиме

## Безопасность API

API эндпоинты для работы с токенами:
- `/api/get_token/{bot_id}/` - проверяет наличие токена, но не возвращает его
- `/api/save_token/{bot_id}/` - доступен только в разработке
- `/api/delete_token/{bot_id}/` - доступен только в разработке

В продакшене эти эндпоинты либо отключены, либо возвращают ошибку доступа.